---
apiVersion: v1
kind: Namespace
metadata:
  name: compute-domain-test-kwok

---
apiVersion: resource.nvidia.com/v1beta1
kind: ComputeDomain
metadata:
  name: kwok-domain
  namespace: compute-domain-test-kwok
spec:
  numNodes: 1
  channel:
    allocationMode: Single
    resourceClaimTemplate:
      name: kwok-domain

---
apiVersion: v1
kind: Pod
metadata:
  namespace: compute-domain-test-kwok
  name: kwok-pod
  labels:
    app: kwok-pod
spec:
  nodeSelector:
    type: kwok
  tolerations:
  - key: kwok.x-k8s.io/node
    operator: Equal
    value: fake
    effect: NoSchedule
  terminationGracePeriodSeconds: 0
  containers:
  - name: ctr0
    image: busybox
    command: ["sh", "-c"]
    args: ["printenv; sleep 9999 & wait"]
    resources:
      claims:
      - name: compute-domain
  resourceClaims:
  - name: compute-domain
    resourceClaimTemplateName: kwok-domain
